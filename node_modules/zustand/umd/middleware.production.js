!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).zustandMiddleware={})}(this,(function(t){"use strict";function e(){return e=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},e.apply(this,arguments)}var n=function(t,n){return function(r,i,o){return o.dispatch=function(e){return r((function(n){return t(n,e)}),!1,e),e},o.dispatchFromDevtools=!0,e({dispatch:function(){var t;return(t=o).dispatch.apply(t,arguments)}},n)}},r=function(t,e){return function(n,r,o){var a,u=void 0===e?{}:"string"==typeof e?{name:e}:e,c=u.enabled;try{a=null!=c&&c&&window.__REDUX_DEVTOOLS_EXTENSION__}catch(t){}if(!a)return t(n,r,o);var s=a.connect(u),f=!0;o.setState=function(t,e,i){var o=n(t,e);return f?(s.send(void 0===i?{type:u.anonymousActionType||"anonymous"}:"string"==typeof i?{type:i}:i,r()),o):o};var d=function(){var t=f;f=!1,n.apply(void 0,arguments),f=t},l=t(o.setState,r,o);if(s.init(l),o.dispatchFromDevtools&&"function"==typeof o.dispatch){var p=o.dispatch;o.dispatch=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];p.apply(void 0,e)}}return s.subscribe((function(t){switch(t.type){case"ACTION":return"string"!=typeof t.payload?void console.error("[zustand devtools middleware] Unsupported action format"):i(t.payload,(function(t){"__setState"!==t.type?o.dispatchFromDevtools&&"function"==typeof o.dispatch&&o.dispatch(t):d(t.state)}));case"DISPATCH":switch(t.payload.type){case"RESET":return d(l),s.init(o.getState());case"COMMIT":return s.init(o.getState());case"ROLLBACK":return i(t.state,(function(t){d(t),s.init(o.getState())}));case"JUMP_TO_STATE":case"JUMP_TO_ACTION":return i(t.state,(function(t){d(t)}));case"IMPORT_STATE":var e,n=t.payload.nextLiftedState,r=null==(e=n.computedStates.slice(-1)[0])?void 0:e.state;if(!r)return;return d(r),void s.send(null,n);case"PAUSE_RECORDING":return f=!f}return}})),l}},i=function(t,e){var n;try{n=JSON.parse(t)}catch(t){console.error("[zustand devtools middleware] Could not parse the received json",t)}void 0!==n&&e(n)},o=function(t){return function(e,n,r){var i=r.subscribe;return r.subscribe=function(t,e,n){var o=t;if(e){var a=(null==n?void 0:n.equalityFn)||Object.is,u=t(r.getState());o=function(n){var r=t(n);if(!a(u,r)){var i=u;e(u=r,i)}},null!=n&&n.fireImmediately&&e(u,u)}return i(o)},t(e,n,r)}},a=function t(e){return function(n){try{var r=e(n);return r instanceof Promise?r:{then:function(e){return t(e)(r)},catch:function(t){return this}}}catch(e){return{then:function(t){return this},catch:function(n){return t(n)(e)}}}}},u=function(t,n){return function(r,i,o){var u,c=e({getStorage:function(){return localStorage},serialize:JSON.stringify,deserialize:JSON.parse,partialize:function(t){return t},version:0,merge:function(t,n){return e({},n,t)}},n),s=!1,f=new Set,d=new Set;try{u=c.getStorage()}catch(t){}if(!u)return t((function(){console.warn("[zustand persist middleware] Unable to update item '"+c.name+"', the given storage is currently unavailable."),r.apply(void 0,arguments)}),i,o);var l=a(c.serialize),p=function(){var t,n=c.partialize(e({},i())),r=l({state:n,version:c.version}).then((function(t){return u.setItem(c.name,t)})).catch((function(e){t=e}));if(t)throw t;return r},v=o.setState;o.setState=function(t,e){v(t,e),p()};var h,y=t((function(){r.apply(void 0,arguments),p()}),i,o),g=function(){if(u){s=!1,f.forEach((function(t){return t(i())}));var t=(null==c.onRehydrateStorage?void 0:c.onRehydrateStorage(i()))||void 0;return a(u.getItem.bind(u))(c.name).then((function(t){if(t)return c.deserialize(t)})).then((function(t){if(t){if("number"!=typeof t.version||t.version===c.version)return t.state;if(c.migrate)return c.migrate(t.state,t.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}})).then((function(t){var e;return h=c.merge(t,null!=(e=i())?e:y),r(h,!0),p()})).then((function(){null==t||t(h,void 0),s=!0,d.forEach((function(t){return t(h)}))})).catch((function(e){null==t||t(void 0,e)}))}};return o.persist={setOptions:function(t){c=e({},c,t),t.getStorage&&(u=t.getStorage())},clearStorage:function(){var t;null==(t=u)||t.removeItem(c.name)},rehydrate:function(){return g()},hasHydrated:function(){return s},onHydrate:function(t){return f.add(t),function(){f.delete(t)}},onFinishHydration:function(t){return d.add(t),function(){d.delete(t)}}},g(),h||y}};t.combine=function(t,e){return function(){return Object.assign({},t,e.apply(void 0,arguments))}},t.devtools=r,t.persist=u,t.redux=n,t.subscribeWithSelector=o,Object.defineProperty(t,"__esModule",{value:!0})}));
