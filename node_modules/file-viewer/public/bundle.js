var app=function(t){"use strict";function e(){}function n(t){return t()}function r(){return Object.create(null)}function o(t){t.forEach(n)}function i(t){return"function"==typeof t}function a(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function s(t,e,n){t.insertBefore(e,n||null)}function c(t){t.parentNode.removeChild(t)}function l(t){return document.createElement(t)}function u(){return t="",document.createTextNode(t);var t}function f(t,e,n){null==n?t.removeAttribute(e):t.setAttribute(e,n)}let d;function p(t){d=t}const m=[],h=[],$=[],g=[],v=Promise.resolve();let b=!1;function x(t){$.push(t)}function y(){const t=new Set;do{for(;m.length;){const t=m.shift();p(t),w(t.$$)}for(;h.length;)h.pop()();for(let e=0;e<$.length;e+=1){const n=$[e];t.has(n)||(n(),t.add(n))}$.length=0}while(m.length);for(;g.length;)g.pop()();b=!1}function w(t){t.fragment&&(t.update(t.dirty),o(t.before_update),t.fragment.p(t.dirty,t.ctx),t.dirty=null,t.after_update.forEach(x))}const _=new Set;function E(t,e){t.$$.dirty||(m.push(t),b||(b=!0,v.then(y)),t.$$.dirty=r()),t.$$.dirty[e]=!0}function C(t,a,s,c,l,u){const f=d;p(t);const m=a.props||{},h=t.$$={fragment:null,ctx:null,props:u,update:e,not_equal:l,bound:r(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(f?f.$$.context:[]),callbacks:r(),dirty:null};let $=!1;var g,v;h.ctx=s?s(t,m,(e,n)=>{h.ctx&&l(h.ctx[e],h.ctx[e]=n)&&(h.bound[e]&&h.bound[e](n),$&&E(t,e))}):m,h.update(),$=!0,o(h.before_update),h.fragment=c(h.ctx),a.target&&(a.hydrate?h.fragment.l(function(t){return Array.from(t.childNodes)}(a.target)):h.fragment.c(),a.intro&&((g=t.$$.fragment)&&g.i&&(_.delete(g),g.i(v))),function(t,e,r){const{fragment:a,on_mount:s,on_destroy:c,after_update:l}=t.$$;a.m(e,r),x(()=>{const e=s.map(n).filter(i);c?c.push(...e):o(e),t.$$.on_mount=[]}),l.forEach(x)}(t,a.target,a.anchor),y()),p(f)}let T;"undefined"!=typeof HTMLElement&&(T=class extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){for(const t in this.$$.slotted)this.appendChild(this.$$.slotted[t])}attributeChangedCallback(t,e,n){this[t]=n}$destroy(){var t,n;n=1,(t=this).$$.fragment&&(o(t.$$.on_destroy),t.$$.fragment.d(n),t.$$.on_destroy=t.$$.fragment=null,t.$$.ctx={}),this.$destroy=e}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(){}});const L=(t,e)=>{switch(S(e)){case"png":case"jpg":case"jpeg":case"gif":case"pdf":return t;case"ppt":case"pptx":case"doc":case"docx":case"xls":case"xlsx":return`https://view.officeapps.live.com/op/embed.aspx?src=${decodeURIComponent(t)}`;default:return"not supported"}},S=t=>t?t.split(".").pop().toLowerCase():null;function k(t){var n;return{c(){(n=l("slot")).textContent="File extension is not supported.",f(n,"name","not-supported")},m(t,e){s(t,n,e)},p:e,d(t){t&&c(n)}}}function A(t){var e,n,r;return{c(){var o,i,a,s;e=l("div"),f(n=l("iframe"),"title",t.filename),f(n,"src",t.formattedUrl),f(n,"frameborder","0"),f(e,"class","file-view-iframe-conatiner"),i="load",a=N,(o=n).addEventListener(i,a,s),r=()=>o.removeEventListener(i,a,s)},m(t,r){s(t,e,r),function(t,e){t.appendChild(e)}(e,n)},p(t,e){t.filename&&f(n,"title",e.filename)},d(t){t&&c(e),r()}}}function j(t){var n;function r(t){return M(t.formattedUrl)||M(t.fileTypeSupported)||!t.fileTypeSupported?k:A}var o=r(t),i=o(t);return{c(){i.c(),n=u(),this.c=e},m(t,e){i.m(t,e),s(t,n,e)},p(t,e){o===(o=r(e))&&i?i.p(t,e):(i.d(1),(i=o(e))&&(i.c(),i.m(n.parentNode,n)))},i:e,o:e,d(t){i.d(t),t&&c(n)}}}function M(t){return null==t}function N(t){const e=new CustomEvent("onload",{detail:"file viewer on load",bubbles:!0,cancelable:!0,composed:!0});this.dispatchEvent(e)}function U(t,e,n){let{url:r=null,filename:o=null}=e;const i=L(r,o),a="not supported"!==i;return t.$set=t=>{"url"in t&&n("url",r=t.url),"filename"in t&&n("filename",o=t.filename)},{url:r,filename:o,formattedUrl:i,fileTypeSupported:a}}class H extends T{constructor(t){super(),this.shadowRoot.innerHTML="<style>.file-view-iframe-conatiner,iframe{height:100%;width:100%}</style>",C(this,{target:this.shadowRoot},U,j,a,["url","filename"]),t&&(t.target&&s(t.target,this,t.anchor),t.props&&(this.$set(t.props),y()))}static get observedAttributes(){return["url","filename"]}get url(){return this.$$.ctx.url}set url(t){this.$set({url:t}),y()}get filename(){return this.$$.ctx.filename}set filename(t){this.$set({filename:t}),y()}}return customElements.define("file-viewer",H),t.App=H,t}({});
